<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Tajniak</title>
<style>
body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
input, select { width: 90%; font-size: 16px; padding: 5px; margin:4px 0; }
button { font-size: 18px; padding: 10px 25px; margin-top: 15px; cursor: pointer; }
#haslo { font-size: 28px; margin-top: 10px; }
#oszust { font-weight: bold; margin-top: 15px; }
.kategorie { margin-top: 30px; }
.kategorie label { display: inline-block; margin: 6px; }
.kategorie input { display: none; }
.kategorie span {
    padding: 10px 16px;
    border-radius: 8px;
    background: #b6f0b6;
    font-weight: bold;
    cursor: pointer;
}
.kategorie input:checked + span { background:#4caf50; color:#fff; }
</style>
</head>
<body>
<h2>Tajniak</h2>

<div id="start">
    <p>IloÅ›Ä‡ graczy:</p>
    <input type="number" id="gracze" value="5" min="3" max="10">

    <div id="imionaBox">
        <p><strong>Imiona graczy:</strong></p>
        <input placeholder="Gracz 1"><input placeholder="Gracz 2"><input placeholder="Gracz 3">
        <input placeholder="Gracz 4"><input placeholder="Gracz 5"><input placeholder="Gracz 6">
        <input placeholder="Gracz 7"><input placeholder="Gracz 8"><input placeholder="Gracz 9">
        <input placeholder="Gracz 10">
    </div>

    <p>Tryb impostorÃ³w:</p>
    <select id="trybImpostora">
        <option value="1">1 impostor</option>
        <option value="2">2 impostorÃ³w</option>
        <option value="losowo">Losowo</option>
    </select>

    <button id="btnStart">Graj</button>
    <button id="btnReset">WyczyÅ›Ä‡ ustawienia</button>  <!-- â†â†â† Nowy przycisk -->

    <div class="kategorie" id="kategorieBox"></div>
</div>

<div id="gra" style="display:none;">
    <h3 id="info"></h3>
    <div id="oszust"></div>
    <button id="btnPokaz">PokaÅ¼ hasÅ‚o</button>
    <div id="haslo"></div>
    <button id="btnDalej" style="display:none;">Podaj telefon dalej!</button>
</div>

<script>
let liczbaGraczy, aktualny=0, impostorzy=[], slowo, imiona=[], jester=null;

/* ===== KATEGORIE ===== */
const kategorie = {
    mikolow: ["rynek","trÄ…bka","dworzec","silver","fresh","szkoÅ‚a 1","szkoÅ‚a 3"],
    miejsca: ["dziaÅ‚ka","bielsko","istebna","passat","lodowisko"],
    swieta: ["piernik","mikoÅ‚aj","mandarynki","uszka","opÅ‚atek"],
    filmy: ["Titanic","Matrix","Breaking Bad","Incepcja","Interstellar","Dark","Gra o Tron","Avatar","Star Wars","Furioza","Narcos"],
    marki: [
        "apple","ferrari","orbit","Axe","dyson","zelmer","level up","simens","bmw","tymbark",
        "perwol","pampers","sony","tesla","cat","sprite","ibuprom","woÅ‚ga","star",
        "legia warszawa","real madryt","orange","T mobil","tauron","panasonic",
        "nike","adidas","coca cola","pepsi","lego","samsung","hp","intel","loreal","red bull",
        "nvidia","cisowianka","tyskie","lech","microsoft","toyota","audi","kfc","milka","prada",
        "rolex","youtube","uber","xbox","playstation","nivea","gillette","netflix","bic","jbl",
        "shell","orlen","nerf","lidl","zalando","aliexpress","temu","twitch","reddit",
        "cd projekt","oreo","pringles","ikea","canon","gopro"
    ],
    rzeczy: [
        "krzesÅ‚o", "stÃ³Å‚", "lampa", "telefon", "komputer", "ksiÄ…Å¼ka", "dÅ‚ugopis", "okno", "drzwi", "samochÃ³d",
        "rower", "butelka", "szklanka", "widelec", "nÃ³Å¼", "Å‚yÅ¼ka", "telewizor", "lodÃ³wka", "pralka", "kuchenka",
        "Å‚Ã³Å¼ko", "poduszka", "koÅ‚dra", "lustro", "zegar", "parasol", "torebka", "portfel", "klucze", "okulary"
    ]
};

/* ===== PODPOWIEDZI MARKI ===== */
const podpowiedziMarki = {
    apple: "przereklamowany",
    ferrari: "czerwony",
    orbit: "oddech",
    Axe: "zapach",
    dyson: "baterie",
    zelmer: "kuchnia",
    "level up": "kiedyÅ› klasa",
    simens: "fabryka",
    bmw: "niemiecki",
    tymbark: "kartonik",
    perwol: "delikatne",
    pampers: "przyjemnoÅ›Ä‡",
    sony: "ekran",
    tesla: "prÄ…d",
    cat: "Å¼Ã³Å‚te",
    sprite: "bÄ…belki",
    ibuprom: "bÃ³l",
    woÅ‚ga: "stare",
    star: "ciÄ™Å¼kie",
    "legia warszawa": "ostrze",
    "real madryt": "galaktyczni",
    orange: "sieÄ‡",
    "T mobil": "rÃ³Å¼owe",
    tauron: "energia",
    panasonic: "sprzÄ™t",
    nike: "skrzydÅ‚o",
    adidas: "trzy paski",
    "coca cola": "Å›wiÄ™ta",
    pepsi: "niebieskie",
    lego: "plastik",
    samsung: "android",
    hp: "drukarka",
    intel: "procesor",
    loreal: "wÅ‚osy",
    "red bull": "skrzydÅ‚a",
    nvidia: "zielone",
    cisowianka: "butelka",
    tyskie: "cudo",
    lech: "poznaÅ„",
    microsoft: "okna",
    toyota: "japonia",
    audi: "cztery",
    kfc: "kurczak",
    milka: "fiolet",
    prada: "drogo",
    rolex: "zÅ‚oto",
    youtube: "play",
    uber: "aplikacja",
    xbox: "pad",
    playstation: "konsola",
    nivea: "krem",
    gillette: "ostrze",
    netflix: "serial",
    bic: "jednorazowe",
    jbl: "gÅ‚oÅ›no",
    shell: "muszla",
    orlen: "orzeÅ‚",
    nerf: "pianka",
    lidl: "tani",
    zalando: "paczka",
    aliexpress: "dÅ‚ugo",
    temu: "reklamy",
    twitch: "live",
    reddit: "forum",
    "cd projekt": "polska",
    oreo: "ciastko",
    pringles: "tuba",
    ikea: "szwedzkie",
    canon: "obiektyw",
    gopro: "akcja"
};

/* ===== PODPOWIEDZI RZECZY ===== */
const podpowiedziRzeczy = {
    
  "krzesÅ‚o": "nogi",
  "stÃ³Å‚": "centrum wydarzeÅ„",
  "lampa": "wieczÃ³r",
  "telefon": "wibracja",
  "komputer": "klawiatura",
  "ksiÄ…Å¼ka": "cisza",
  "dÅ‚ugopis": "egzamin",
  "okno": "ucieczka",
  "drzwi": "granica",
  "samochÃ³d": "korek",
  "rower": "Å‚aÅ„cuch",
  "butelka": "zakrÄ™tka",
  "szklanka": "krucha",
  "widelec": "metal",
  "nÃ³Å¼": "ostroÅ¼nie",
  "Å‚yÅ¼ka": "okrÄ…gÅ‚a",
  "telewizor": "pilot",
  "lodÃ³wka": "nocne wizyty",
  "pralka": "wirowanie",
  "kuchenka": "gaz",
  "Å‚Ã³Å¼ko": "rano",
  "poduszka": "ksztaÅ‚t",
  "koÅ‚dra": "zimÄ…",
  "lustro": "prawda",
  "zegar": "tykanie",
  "parasol": "nagÅ‚a decyzja",
  "torebka": "baÅ‚agan",
  "portfel": "pustka",
  "klucze": "brzÄ™k",
  "okulary": "szkÅ‚o"
};

/* ===== WSZYSTKIE PODPOWIEDZI ===== */
const podpowiedzi = { ...podpowiedziMarki, ...podpowiedziRzeczy };

/* ===== ZAPAMIÄ˜TYWANIE USTAWIEN ===== */
function zapiszUstawienia() {
    const dane = {
        gracze: liczbaGraczy,
        imiona: imiona,
        tryb: document.getElementById("trybImpostora").value,
        kategorie: Array.from(document.querySelectorAll(".kat:checked")).map(ch => ch.value)
    };
    localStorage.setItem("tajniak_config", JSON.stringify(dane));
}

function wczytajUstawienia() {
    const zapis = localStorage.getItem("tajniak_config");
    if (!zapis) return;

    try {
        const dane = JSON.parse(zapis);

        // iloÅ›Ä‡ graczy
        document.getElementById("gracze").value = dane.gracze || 5;

        // imiona
        const inputy = document.querySelectorAll("#imionaBox input");
        (dane.imiona || []).forEach((imie, i) => {
            if (inputy[i]) inputy[i].value = imie;
        });

        // tryb impostora
        if (dane.tryb) {
            document.getElementById("trybImpostora").value = dane.tryb;
        }

        // kategorie
        document.querySelectorAll(".kat").forEach(checkbox => {
            if (dane.kategorie.includes(checkbox.value)) {
                checkbox.checked = true;
            }
        });

        // odÅ›wieÅ¼ wyglÄ…d checkboxÃ³w (kolory)
        document.querySelectorAll(".kat").forEach(ch => {
            const span = ch.nextElementSibling;
            if (span) {
                span.style.background = ch.checked ? "#4caf50" : "#b6f0b6";
                span.style.color = ch.checked ? "#fff" : "";
            }
        });

    } catch (e) {
        console.warn("BÅ‚Ä…d wczytywania zapisanej konfiguracji", e);
    }
}

/* ===== RENDER KATEGORII ===== */
function renderKategorie(){
    const box = document.getElementById("kategorieBox");
    box.innerHTML = "<p><strong>Wybierz kategorie:</strong></p>";
    Object.keys(kategorie).forEach(k => {
        box.innerHTML += `<label><input type="checkbox" class="kat" value="${k}"><span>${k}</span></label>`;
    });
}
renderKategorie();

/* ===== START GRY ===== */
btnStart.onclick = () => {
    liczbaGraczy = +gracze.value;
    imiona = [...document.querySelectorAll("#imionaBox input")]
        .slice(0, liczbaGraczy)
        .map((i, n) => i.value.trim() || `Gracz ${n+1}`);

    let lista = [];
    document.querySelectorAll(".kat:checked").forEach(k => lista = lista.concat(kategorie[k.value]));

    if (lista.length === 0) {
        alert("Wybierz przynajmniej jednÄ… kategoriÄ™!");
        return;
    }

    slowo = lista[Math.floor(Math.random() * lista.length)];

    impostorzy = [];
    let ilosc = trybImpostora.value === "losowo" ? (Math.random() < 0.5 ? 1 : 2) : +trybImpostora.value;

    while (impostorzy.length < ilosc) {
        let i = Math.floor(Math.random() * liczbaGraczy);
        if (!impostorzy.includes(i)) impostorzy.push(i);
    }

    jester = null;
    if (Math.random() < 0.1) {  // â†â†â† Zmniejszone prawdopodobieÅ„stwo jestera (z 0.3 na 0.2)
        do { jester = Math.floor(Math.random() * liczbaGraczy); }
        while (impostorzy.includes(jester));
    }

    aktualny = 0;

    zapiszUstawienia();   // <--- ZAPISUJEMY USTAWIENIA

    start.style.display = "none";
    gra.style.display = "block";
    pokazInfo();
};

/* ===== EKRAN GRY ===== */
function pokazInfo(){
    info.innerText = imiona[aktualny];
    haslo.innerText = "";
    oszust.innerText = "";
    btnDalej.style.display = "none";
}

btnPokaz.onclick = () => {
    if (aktualny === jester) {
        oszust.innerText = "JESTER â€“ MUSISZ ODPAÅšÄ† JAKO PIERWSZY";
        haslo.innerText = "ðŸ¤¡";
    }
    else if (impostorzy.includes(aktualny)) {
        oszust.innerText = "JESTEÅš OSZUSTEM!";
        haslo.innerText = podpowiedzi[slowo] || "âŒ BRAK HASÅA";
    }
    else {
        haslo.innerText = slowo;
    }
    btnDalej.style.display = "inline";
};

btnDalej.onclick = () => {
    aktualny++;
    if (aktualny >= liczbaGraczy) {
        location.reload();
    } else {
        pokazInfo();
    }
};

// Wczytaj zapisane ustawienia po zaÅ‚adowaniu strony
wczytajUstawienia();

// ObsÅ‚uga resetu ustawieÅ„
document.getElementById("btnReset").onclick = () => {
    localStorage.removeItem("tajniak_config");  // UsuÅ„ zapis
    location.reload();  // OdÅ›wieÅ¼ stronÄ™
};

</script>
</body>
</html>

