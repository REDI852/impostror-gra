<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Tajniak</title>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
}
input, select {
    width: 90%;
    font-size: 16px;
    padding: 5px;
    margin: 4px 0;
}
button {
    font-size: 18px;
    padding: 10px 25px;
    margin-top: 15px;
    cursor: pointer;
}
#haslo {
    font-size: 28px;
    margin-top: 10px;
}
#oszust {
    font-weight: bold;
    margin-top: 15px;
}
.kategorie {
    margin-top: 30px;
}
.kategorie label {
    display: inline-block;
    margin: 6px;
}
.kategorie input {
    display: none;
}
.kategorie span {
    padding: 10px 16px;
    border-radius: 8px;
    background: #b6f0b6;
    font-weight: bold;
    cursor: pointer;
}
.kategorie input:checked + span {
    background: #4caf50;
    color: #fff;
}
</style>
</head>

<body>

<h2>Tajniak</h2>

<div id="start">
    <p>Ilo≈õƒá graczy:</p>
    <input type="number" id="gracze" value="5" min="3" max="10">

    <div id="imionaBox">
        <p><strong>Imiona graczy:</strong></p>
        <input placeholder="Gracz 1">
        <input placeholder="Gracz 2">
        <input placeholder="Gracz 3">
        <input placeholder="Gracz 4">
        <input placeholder="Gracz 5">
        <input placeholder="Gracz 6">
        <input placeholder="Gracz 7">
        <input placeholder="Gracz 8">
        <input placeholder="Gracz 9">
        <input placeholder="Gracz 10">
    </div>

    <p>Tryb impostor√≥w:</p>
    <select id="trybImpostora">
        <option value="1">1 impostor</option>
        <option value="2">2 impostor√≥w</option>
        <option value="losowo">Losowo</option>
    </select>

    <button id="btnStart">Graj</button>
    <button id="btnReset">Wyczy≈õƒá ustawienia</button>

    <div class="kategorie" id="kategorieBox"></div>
</div>

<div id="gra" style="display:none;">
    <h3 id="info"></h3>
    <div id="oszust"></div>
    <button id="btnPokaz">Poka≈º has≈Ço</button>
    <div id="haslo"></div>
    <button id="btnDalej" style="display:none;">Podaj telefon dalej!</button>
</div>

<script>
let liczbaGraczy, aktualny = 0, impostorzy = [], slowo, imiona = [], jester = null;

/* ===== KATEGORIE ===== */
const kategorie = {
    mikolow: ["rynek","trƒÖbka","dworzec","silver","fresh","szko≈Ça 1","szko≈Ça 3"],
    miejsca: ["dzia≈Çka","bielsko","istebna","passat","lodowisko"],
    swieta: ["piernik","miko≈Çaj","mandarynki","uszka","op≈Çatek"],
    filmy: ["Titanic","Matrix","Breaking Bad","Incepcja","Interstellar","Dark","Gra o Tron","Avatar","Star Wars","Furioza","Narcos"],
    marki: [
        "apple","ferrari","orbit","Axe","dyson","zelmer","level up","simens","bmw","tymbark",
        "perwol","pampers","sony","tesla","cat","sprite","ibuprom","wo≈Çga","star",
        "legia warszawa","real madryt","orange","T mobil","tauron","panasonic",
        "nike","adidas","coca cola","pepsi","lego","samsung","hp","intel","loreal","red bull",
        "nvidia","cisowianka","tyskie","lech","microsoft","toyota","audi","kfc","milka","prada",
        "rolex","youtube","uber","xbox","playstation","nivea","gillette","netflix","bic","jbl",
        "shell","orlen","nerf","lidl","zalando","aliexpress","temu","twitch","reddit",
        "cd projekt","oreo","pringles","ikea","canon","gopro"
    ],
    rzeczy: [
        "krzes≈Ço","st√≥≈Ç","lampa","telefon","komputer","ksiƒÖ≈ºka","d≈Çugopis","okno","drzwi",
        "samoch√≥d","rower","butelka","szklanka","widelec","n√≥≈º","≈Çy≈ºka","telewizor","lod√≥wka",
        "pralka","kuchenka","≈Ç√≥≈ºko","poduszka","ko≈Çdra","lustro","zegar","parasol","torebka",
        "portfel","klucze","okulary"
    ]
};

/* ===== PODPOWIEDZI ===== */
const podpowiedzi = {
    apple:"przereklamowany", ferrari:"czerwony", orbit:"oddech", Axe:"zapach",
    dyson:"baterie", zelmer:"kuchnia", "level up":"kiedy≈õ klasa", simens:"fabryka",
    bmw:"niemiecki", tymbark:"kartonik", perwol:"delikatne", pampers:"przyjemno≈õƒá",
    sony:"ekran", tesla:"prƒÖd", cat:"≈º√≥≈Çte", sprite:"bƒÖbelki", ibuprom:"b√≥l",
    wo≈Çga:"stare", star:"ciƒô≈ºkie", "legia warszawa":"ostrze", "real madryt":"galaktyczni",
    orange:"sieƒá", "T mobil":"r√≥≈ºowe", tauron:"energia", panasonic:"sprzƒôt",
    nike:"skrzyd≈Ço", adidas:"trzy paski", "coca cola":"≈õwiƒôta", pepsi:"niebieskie",
    lego:"plastik", samsung:"android", hp:"drukarka", intel:"procesor",
    loreal:"w≈Çosy", "red bull":"skrzyd≈Ça", nvidia:"zielone", cisowianka:"butelka",
    tyskie:"cudo", lech:"pozna≈Ñ", microsoft:"okna", toyota:"japonia",
    audi:"cztery", kfc:"kurczak", milka:"fiolet", prada:"drogo", rolex:"z≈Çoto",
    youtube:"play", uber:"aplikacja", xbox:"pad", playstation:"konsola",
    nivea:"krem", gillette:"ostrze", netflix:"serial", bic:"jednorazowe",
    jbl:"g≈Ço≈õno", shell:"muszla", orlen:"orze≈Ç", nerf:"pianka", lidl:"tani",
    zalando:"paczka", aliexpress:"d≈Çugo", temu:"reklamy", twitch:"live",
    reddit:"forum", "cd projekt":"polska", oreo:"ciastko", pringles:"tuba",
    ikea:"szwedzkie", canon:"obiektyw", gopro:"akcja",
    krzes≈Ço:"nogi", st√≥≈Ç:"centrum wydarze≈Ñ", lampa:"wiecz√≥r", telefon:"wibracja",
    komputer:"klawiatura", ksiƒÖ≈ºka:"cisza", d≈Çugopis:"duda", okno:"ucieczka",
    drzwi:"granica", samoch√≥d:"korek", rower:"≈Ça≈Ñcuch", butelka:"zakrƒôtka",
    szklanka:"krucha", widelec:"metal", n√≥≈º:"ostro≈ºnie", ≈Çy≈ºka:"okrƒÖg≈Ça",
    telewizor:"pilot", lod√≥wka:"nocne wizyty", pralka:"wirowanie",
    kuchenka:"gaz", ≈Ç√≥≈ºko:"rano", poduszka:"kszta≈Çt", ko≈Çdra:"zimƒÖ",
    lustro:"prawda", zegar:"tykanie", parasol:"nag≈Ça decyzja",
    torebka:"ba≈Çagan", portfel:"pustka", klucze:"brzƒôk", okulary:"szk≈Ço"
};

/* ===== ZAPIS / ODCZYT ===== */
function zapiszUstawienia() {
    const dane = {
        gracze: liczbaGraczy,
        imiona: imiona,
        tryb: trybImpostora.value,
        kategorie: [...document.querySelectorAll(".kat:checked")].map(x => x.value)
    };
    localStorage.setItem("tajniak_config", JSON.stringify(dane));
}

function wczytajUstawienia() {
    const zapis = localStorage.getItem("tajniak_config");
    if (!zapis) return;
    const dane = JSON.parse(zapis);

    gracze.value = dane.gracze || 5;

    document.querySelectorAll("#imionaBox input").forEach((i, idx) => {
        if (dane.imiona && dane.imiona[idx]) i.value = dane.imiona[idx];
    });

    if (dane.tryb) trybImpostora.value = dane.tryb;

    document.querySelectorAll(".kat").forEach(ch => {
        if (dane.kategorie?.includes(ch.value)) ch.checked = true;
    });
}

/* ===== KATEGORIE ===== */
function renderKategorie() {
    const box = document.getElementById("kategorieBox");
    box.innerHTML = "<p><strong>Wybierz kategorie:</strong></p>";
    Object.keys(kategorie).forEach(k => {
        box.innerHTML += `
            <label>
                <input type="checkbox" class="kat" value="${k}">
                <span>${k}</span>
            </label>
        `;
    });
}

renderKategorie();
wczytajUstawienia();

/* ===== START ===== */
btnStart.onclick = () => {
    liczbaGraczy = +gracze.value;

    imiona = [...document.querySelectorAll("#imionaBox input")]
        .slice(0, liczbaGraczy)
        .map((i, n) => i.value.trim() || `Gracz ${n+1}`);

    let lista = [];
    document.querySelectorAll(".kat:checked").forEach(k => {
        lista = lista.concat(kategorie[k.value]);
    });

    if (!lista.length) return alert("Wybierz kategoriƒô!");

    slowo = lista[Math.floor(Math.random() * lista.length)];

    impostorzy = [];
    let ilosc = trybImpostora.value === "losowo"
        ? (Math.random() < 0.5 ? 1 : 2)
        : +trybImpostora.value;

    while (impostorzy.length < ilosc) {
        let i = Math.floor(Math.random() * liczbaGraczy);
        if (!impostorzy.includes(i)) impostorzy.push(i);
    }

    jester = null;
    if (Math.random() < 0.3) {
        do {
            jester = Math.floor(Math.random() * liczbaGraczy);
        } while (impostorzy.includes(jester));
    }

    aktualny = 0;
    zapiszUstawienia();
    start.style.display = "none";
    gra.style.display = "block";
    pokazInfo();
};

/* ===== GRA ===== */
function pokazInfo() {
    info.innerText = imiona[aktualny];
    haslo.innerText = "";
    oszust.innerText = "";
    btnDalej.style.display = "none";
}

btnPokaz.onclick = () => {
    if (aktualny === jester) {
        oszust.innerText = "JESTERü§° ‚Äì MUSISZ ODPA≈öƒÜ JAKO PIERWSZY";
        haslo.innerText = slowo;
    } else if (impostorzy.includes(aktualny)) {
        oszust.innerText = "JESTE≈ö OSZUSTEM!";
        haslo.innerText = podpowiedzi[slowo] || "‚ùå";
    } else {
        haslo.innerText = slowo;
    }
    btnDalej.style.display = "inline";
};

btnDalej.onclick = () => {
    aktualny++;
    if (aktualny >= liczbaGraczy) location.reload();
    else pokazInfo();
};

btnReset.onclick = () => {
    localStorage.removeItem("tajniak_config");
    location.reload();
};
</script>

</body>
</html>
